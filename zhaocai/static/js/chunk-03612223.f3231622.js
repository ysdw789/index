(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03612223"],{"69e8":function(t,e,a){"use strict";a("c526")},8916:function(t,e,a){"use strict";var r=a("b775");e["a"]={getLogList:function(t,e){return Object(r["a"])({url:"/log/info",method:"get",params:{currentPage:t,pageSize:e}})}}},a15b:function(t,e,a){"use strict";var r=a("23e7"),i=a("44ad"),o=a("fc6a"),n=a("a640"),s=[].join,l=i!=Object,u=n("join",",");r({target:"Array",proto:!0,forced:l||!u},{join:function(t){return s.call(o(this),void 0===t?",":t)}})},aa22:function(t,e,a){"use strict";var r=a("b775");e["a"]={getList:function(t,e,a,i){return Object(r["a"])({url:"/server/listByPage",method:"get",params:{currentPage:t,pageSize:e,keywordIP:a,keywordComment:i}})},getAllList:function(){return Object(r["a"])({url:"/server/list",method:"get"})},addServer:function(t){return Object(r["a"])({url:"/server/add",method:"post",data:t})},updateServer:function(t){return Object(r["a"])({url:"/server/update",method:"post",data:t})},getServerById:function(t){return Object(r["a"])({url:"/server/getServerById",method:"get",params:{serverId:t}})},delServerById:function(t){return Object(r["a"])({url:"/server/delServerById",method:"get",params:{serverId:t}})},synchronizationCustomer:function(){return Object(r["a"])({url:"/server/synchronizationCustomer",method:"get"})}}},aedf:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"客户账号"}},[a("el-input",{attrs:{placeholder:"账户名或密码查询"},model:{value:t.queryCondition.keyWord,callback:function(e){t.$set(t.queryCondition,"keyWord",e)},expression:"queryCondition.keyWord"}})],1),a("el-form-item",{attrs:{label:"创建日期"}},[a("el-date-picker",{staticStyle:{width:"165px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.queryCondition.createTime,callback:function(e){t.$set(t.queryCondition,"createTime",e)},expression:"queryCondition.createTime"}})],1),a("el-form-item",{attrs:{label:"所属应用"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:!0,placeholder:"请选择"},model:{value:t.queryCondition.appId,callback:function(e){t.$set(t.queryCondition,"appId",e)},expression:"queryCondition.appId"}},t._l(t.appList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"到期状态"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:!0,placeholder:"请选择"},model:{value:t.queryCondition.expireStatu,callback:function(e){t.$set(t.queryCondition,"expireStatu",e)},expression:"queryCondition.expireStatu"}},[a("el-option",{attrs:{label:"未到期",value:"0"}}),a("el-option",{attrs:{label:"已到期",value:"1"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchBtn}},[t._v("查询")])],1)],1)],1),a("el-card",{staticClass:"box-card"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-button",{staticClass:"operBtn",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.showAddCustomerDialog}},[t._v("新增")]),a("el-button",{staticClass:"operBtn",attrs:{disabled:0==this.batchSelectList.length,size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:t.bacthDelCustomer}},[t._v("批量删除")]),a("el-button",{staticClass:"operBtn",attrs:{disabled:0==this.batchSelectList.length,type:"success",size:"mini",icon:"el-icon-present"},on:{click:t.batchAddTime}},[t._v("加时")]),a("el-tooltip",{attrs:{effect:"dark",content:"同步CCP服务器的用户数据",placement:"top"}},[a("el-button",{staticClass:"operBtn",attrs:{size:"mini",type:"info",icon:"el-icon-refresh"},on:{click:t.synchronizationCustomer}},[t._v("同步")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tbaleLoading,expression:"tbaleLoading"}],ref:"customerTable",staticStyle:{width:"100%"},attrs:{size:"small","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"element-loading-text":"别着急先去抽根烟",stripe:!0,border:!0,data:t.tableData,height:"400","max-height":"500"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",type:"index",width:"60"}}),a("el-table-column",{attrs:{prop:"username",label:"账户名",width:"120"}}),a("el-table-column",{attrs:{prop:"password",label:"密码",width:"120"}}),a("el-table-column",{attrs:{prop:"enable",label:"账户状态",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0","active-text":"开","inactive-text":"关"},on:{change:function(a){return t.customerStatuSwitch(e.row)}},model:{value:e.row.enable,callback:function(a){t.$set(e.row,"enable",a)},expression:"scope.row.enable"}})]}}])}),a("el-table-column",{attrs:{prop:"appName",label:"所属应用或同步服务器",width:"175"}}),a("el-table-column",{attrs:{prop:"dwWidth",label:"下行带宽",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("-1"===e.row.dwWidth?"无限制":e.row.dwWidth/1024+"/kb")+" ")]}}])}),a("el-table-column",{attrs:{prop:"upWidth",label:"上行带宽",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("-1"===e.row.upWidth?"无限制":e.row.upWidth/1024+"/kb")+" ")]}}])}),a("el-table-column",{attrs:{prop:"disableDate",label:"到期日期",width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.disableDate+" "+e.row.disableTime)+" ")]}}])}),a("el-table-column",{attrs:{prop:"expireStatu",label:"到期状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(t){return["0"===t.row.expireStatu?a("div",{staticClass:"noExpireStatu"}):a("div",{staticClass:"expireStatu"})]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建日期",width:"145"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"margin-right":"6px"},attrs:{size:"mini"},on:{click:function(a){return t.showUpdateCustomerDialog(e.row.id)}}},[t._v(" 修改 ")]),a("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定删除该客户吗？"},on:{onConfirm:function(a){return t.delCustomer(e.row.username,e.row.serverId)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v(" 移除 ")])],1)]}}])})],1),a("br"),t.windowWidth>=750?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,50,100,200,300],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e(),t.windowWidth<=749?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{small:"","page-size":t.pageSize,layout:"total,prev, pager, next",total:t.totalCount},on:{"current-change":t.handleCurrentChange}})],1):t._e(),a("el-dialog",{attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,title:t.dialogTitle,visible:t.dialogVisible,width:t.windowWidth<=750?"85%":"30%"},on:{closed:function(e){return t.dialogClosed()},"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"addCustomerForm",attrs:{size:"small","status-icon":"","label-width":"90px",model:t.customer,rules:t.rules}},[a("el-form-item",{attrs:{label:"用户名:",prop:"username"}},[a("el-input",{attrs:{placeholder:"6~10位，数字字母组合"},model:{value:t.customer.username,callback:function(e){t.$set(t.customer,"username",e)},expression:"customer.username"}})],1),a("el-form-item",{attrs:{label:"密码:",prop:"password"}},[a("el-input",{attrs:{placeholder:"6~10位，数字字母组合"},model:{value:t.customer.password,callback:function(e){t.$set(t.customer,"password",e)},expression:"customer.password"}})],1),a("el-form-item",{attrs:{label:"下行带宽:",prop:"dwWidth"}},[a("el-input",{attrs:{placeholder:"-1无限制,整数值单位(kb)"},model:{value:t.customer.dwWidth,callback:function(e){t.$set(t.customer,"dwWidth",e)},expression:"customer.dwWidth"}})],1),a("el-form-item",{attrs:{label:"上行带宽:",prop:"upWidth"}},[a("el-input",{attrs:{placeholder:"-1无限制,整数值单位(kb)"},model:{value:t.customer.upWidth,callback:function(e){t.$set(t.customer,"upWidth",e)},expression:"customer.upWidth"}})],1),null==t.customer.id?a("el-form-item",{attrs:{label:"初始时长:",required:""}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{prop:"longTime"}},[a("el-input-number",{staticStyle:{width:"120px"},attrs:{min:1,max:30,placeholder:"时长"},model:{value:t.customer.longTime,callback:function(e){t.$set(t.customer,"longTime",e)},expression:"customer.longTime"}})],1)],1),a("el-col",{staticClass:"unit-column",staticStyle:{width:"120px"},attrs:{span:12}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{prop:"unit"}},[a("el-select",{attrs:{placeholder:"请选择单位"},model:{value:t.customer.unit,callback:function(e){t.$set(t.customer,"unit",e)},expression:"customer.unit"}},[a("el-option",{attrs:{label:"小时",value:"小时"}}),a("el-option",{attrs:{label:"天卡",value:"天"}}),a("el-option",{attrs:{label:"周卡",value:"周"}}),a("el-option",{attrs:{label:"月卡",value:"月"}}),a("el-option",{attrs:{label:"年卡",value:"年"}})],1)],1)],1)],1):t._e(),a("el-form-item",{attrs:{label:"所属应用:",prop:"appId"}},[a("el-select",{attrs:{placeholder:"请选择所属应用"},on:{change:t.appSelectChange},model:{value:t.customer.appId,callback:function(e){t.$set(t.customer,"appId",e)},expression:"customer.appId"}},t._l(t.appList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addOrUpdate}},[t._v("确 定")])],1)],1)],1)],1)},i=[],o=(a("ac1f"),a("00b4"),a("a9e3"),a("a15b"),a("d81d"),a("b0c0"),a("b562")),n=a("aa22"),s=(a("99af"),a("b775")),l={getListByPage:function(t,e,a){return Object(s["a"])({url:"/customer/getListByPage",method:"get",params:{currentPage:t,pageSize:e,keyWord:a.keyWord,expireStatu:a.expireStatu,appId:a.appId,createTime:a.createTime}})},addCustomerByAdmin:function(t){return Object(s["a"])({url:"/customer/addCustomerByAdmin",method:"post",data:{username:t.username,password:t.password,dwWidth:t.dwWidth,upWidth:t.upWidth,longTime:t.longTime,unit:t.unit,appId:t.appId,appName:t.appName,serverId:t.serverId}})},delCustomer:function(t,e){return Object(s["a"])({url:"/customer/del/".concat(e,"/").concat(t),method:"get"})},delCustomerBatch:function(t,e,a){return Object(s["a"])({url:"/customer/delBatch",method:"get",params:{names:t,ids:e,serverIds:a}})},getCustomerById:function(t){return Object(s["a"])({url:"/customer/".concat(t),method:"get"})},updateCustomer:function(t){return Object(s["a"])({url:"/customer/update",method:"post",data:t})}},u=(a("8916"),{mounted:function(){var t=this;window.onresize=function(){return function(){t.windowWidth=window.innerWidth}()}},data:function(){var t=function(t,e,a){if(""===e)a(new Error("-1无限制,最多三位数，单位(kb)"));else if("-1"!=e){var r=/^\d{0,3}$/;r.test(e)||a(new Error("-1无限制,最多三位数kb为单位")),a()}else a()},e=function(t,e,a){if(""===e)a(new Error("-1无限制,最多三位数，单位(kb)"));else if("-1"!=e){var r=/^\d{0,3}$/;r.test(e)||a(new Error("-1无限制,最多三位数，单位(kb)")),a()}else a()};return{customer:{longTime:1,unit:"天",dwWidth:"-1",upWidth:"-1"},rules:{username:{required:!0,pattern:/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d]{6,10}$/,message:"用户名6~10位，数字与字母混合",trigger:"blur"},password:{required:!0,pattern:/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d]{6,10}$/,message:"密码6~10位，数字与字母混合",trigger:"blur"},longTime:{required:!0,message:"初始时长必填",trigger:"blur"},unit:{required:!0,message:"单位必填",trigger:"blur"},appId:{required:!0,message:"应用必选",trigger:"blur"},dwWidth:{validator:t,trigger:"blur"},upWidth:{validator:e,trigger:"blur"}},batchSelectList:[],queryCondition:{},appList:[],dialogTitle:"",dialogVisible:!1,tbaleLoading:!0,windowWidth:0,tableData:[],currentPage:1,pageSize:50,totalCount:0,totalPage:0}},methods:{handleSizeChange:function(t){this.pageSize=t,this.getCustomerList()},handleCurrentChange:function(t){this.currentPage=t,this.getCustomerList()},getAppList:function(){var t=this;o["a"].getList().then((function(e){t.appList=e.data.appList}))},getCustomerList:function(){var t=this;l.getListByPage(this.currentPage,this.pageSize,this.queryCondition).then((function(e){t.tbaleLoading=!1,t.tableData=e.data.customerList,t.totalCount=e.data.totalCount,t.totalPage=e.data.totalPage})).catch((function(e){t.tbaleLoading=!1}))},showAddCustomerDialog:function(){this.dialogTitle="新增客户",this.dialogVisible=!0},showUpdateCustomerDialog:function(t){var e=this;this.dialogTitle="修改客户",l.getCustomerById(t).then((function(t){e.customer=t.data.customer,-1!=e.customer.appName.indexOf(".")&&(e.customer.appId=null),"-1"!=e.customer.dwWidth&&(e.customer.dwWidth=Number(e.customer.dwWidth)/1024),"-1"!=e.customer.upWidth&&(e.customer.upWidth=Number(e.customer.upWidth)/1024),e.dialogVisible=!0}))},searchBtn:function(){this.currentPage=1,this.getCustomerList()},addOrUpdate:function(){var t=this;this.$refs.addCustomerForm.validate((function(e){console.log("表单校验",e),e&&(t.customer.id?t.updateCustomer():t.addCustomer())}))},addCustomer:function(){var t=this;this.daikuanZhuanHuan(),l.addCustomerByAdmin(this.customer).then((function(e){t.dialogVisible=!1,t.$message({message:"添加成功",type:"success"}),t.getCustomerList()}))},updateCustomer:function(){var t=this;this.dialogVisible=!1,this.daikuanZhuanHuan(),l.updateCustomer(this.customer).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getCustomerList()}))},dialogClosed:function(){this.customer={dwWidth:"-1",upWidth:"-1",longTime:1,unit:"天"},this.$refs.addCustomerForm.clearValidate()},delCustomer:function(t,e){var a=this;l.delCustomer(t,e).then((function(t){a.$message({message:"删除成功",type:"success"}),a.getCustomerList()}))},handleSelectionChange:function(t){this.batchSelectList=[],this.batchSelectList=t},daikuanZhuanHuan:function(){"-1"!=this.customer.dwWidth&&(this.customer.dwWidth=1024*Number(this.customer.dwWidth)),"-1"!=this.customer.upWidth&&(this.customer.upWidth=1024*Number(this.customer.upWidth))},bacthDelCustomer:function(){var t=this;null==this.batchSelectList||this.batchSelectList.length<=0?alert("至少勾选一个需要删除的客户！"):this.$confirm("此操作将永久删除所有已选择的客户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.batchSelectList.map((function(t){return t.id})).join(),a=t.batchSelectList.map((function(t){return t.username})).join(),r=t.batchSelectList.map((function(t){return t.serverId})).join();l.delCustomerBatch(a,e,r).then((function(e){t.synchronizationCustomer()})).catch((function(e){t.synchronizationCustomer()}))})).catch((function(){t.$message({message:"取消删除",type:"info"}),t.$refs.customerTable.clearSelection()}))},batchAddTime:function(){this.$message.warning("功能不难，哪天心情好了再开发")},synchronizationCustomer:function(){var t=this;n["a"].synchronizationCustomer().then((function(e){t.$message.success("同步成功"),t.getCustomerList()}))},customerStatuSwitch:function(t){var e=this;l.updateCustomer(t).then((function(t){e.getCustomerList(),e.$message({message:"操作成功！",type:"success"})}))},appSelectChange:function(t){if(t){for(var e=0;e<this.appList.length;e++){var a=this.appList[e];a.id==t&&(this.customer.appName=a.name,this.customer.serverId=a.serverId)}this.$refs.addCustomerForm.clearValidate("appId")}}},created:function(){this.getCustomerList(),this.getAppList(),this.windowWidth=window.innerWidth,this.synchronizationCustomer()}}),c=u,d=(a("69e8"),a("2877")),p=Object(d["a"])(c,r,i,!1,null,"201dbf8a",null);e["default"]=p.exports},b562:function(t,e,a){"use strict";var r=a("b775");e["a"]={getListByPage:function(t,e,a,i){return Object(r["a"])({url:"/app/listByPage",method:"get",params:{currentPage:t,pageSize:e,keyword:a,serverId:i}})},getList:function(){return Object(r["a"])({url:"/app/list",method:"post"})},addApp:function(t){return Object(r["a"])({url:"/app/add",method:"post",data:t})},delAppById:function(t){return Object(r["a"])({url:"/app/delAppById",method:"get",params:{appId:t}})},changeServer:function(t,e){return Object(r["a"])({url:"/app/updateServer",method:"post",data:{id:t,serverId:e}})}}},c526:function(t,e,a){}}]);